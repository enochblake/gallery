(()=>{var e={274:e=>{e.exports={mongoURI:{production:"mongodb+srv://blakekibet:Enoch@9627@gallery.wc344.mongodb.net/darkroom?retryWrites=true&w=majority",development:"mongodb+srv://blakekibet:Enoch@9627@gallery.wc344.mongodb.net/darkroom-dev?retryWrites=true&w=majority",test:"mongodb+srv://blakekibet:Enoch@9627@gallery.wc344.mongodb.net/darkroom-test?retryWrites=true&w=majority"}}},656:(e,t,r)=>{const o=r(37);var s=new(0,o.Schema)({name:String,path:String,size:Number,date:{type:Date,default:Date()}});let i=o.model("Image",s);e.exports=i},393:(e,t,r)=>{const o=r(252).Router();let s=r(656);o.get("/:id",((e,t)=>{s.findById(e.params.id,(function(e,r){e&&console.log(e),t.render("singleImage",{title:"Single Image",image:r})}))})),o.put("/:id",((e,t)=>{console.log(e.params.id),console.log(e.body),s.updateOne({_id:e.params.id},{$set:{name:e.body.name}},{upsert:!0},(function(e,r){e&&console.log(e),t.redirect("/")}))})),o.delete("/:id",((e,t)=>{console.log(e.params.id),s.deleteOne({_id:e.params.id},(function(e){e&&console.log(e),t.redirect("/index")}))})),e.exports=o},4:(e,t,r)=>{const o=r(252).Router();r(903);let s=r(79);r(16);let i=r(656);o.get("/",((e,t)=>{i.find({},(function(r,o){r&&console.log(r),t.render("index",{images:o,msg:e.query.msg})}))})),o.post("/upload",((e,t)=>{s(e,t,(r=>{r?t.redirect(`/?msg=${r}`):(console.log(e.file),null==e.file?t.redirect("/?msg=Error: No file selcted!"):(new i({name:e.file.filename,size:e.file.size,path:"images/"+e.file.filename}).save(),t.redirect("/?msg=File uploaded successfully")))}))})),e.exports=o},79:(e,t,r)=>{const o=r(461),s=r(928),i=o.diskStorage({destination:"./public/images/",filename:function(e,t,r){r(null,t.fieldname+"-"+Date.now()+s.extname(t.originalname))}}),n=o({storage:i,limits:{fileSize:1e6},fileFilter:function(e,t,r){!function(e,t){const r=/jpeg|jpg|png|gif/,o=r.test(s.extname(e.originalname).toLowerCase());if(r.test(e.mimetype)&&o)return t(null,!0);t("Error: Images Only!!")}(t,r)}}).single("image");e.exports=n},578:(e,t,r)=>{const o=r(252),s=(r(268),r(37)),i=r(928);r(274);let n=r(4),l=r(393);const a=o();s.connect("mongodb+srv://blakekibet:Enoch@9627@cluster0.0ira5.mongodb.net/?retryWrites=true&w=majority&appName=DevopsClusterdarkroom",{useNewUrlParser:!0,useUnifiedTopology:!0},(e=>{e&&console.log(e)})),a.set("view engine","ejs"),a.use(o.static(i.join(__dirname,"public"))),a.use(o.json()),a.use("/",n),a.use("/image",l);const m=process.env.PORT||4e3;a.listen(m,(()=>{console.log(`Server is listening at http://localhost:${m}`)})),e.exports=a},268:e=>{"use strict";e.exports=require("body-parser")},252:e=>{"use strict";e.exports=require("express")},37:e=>{"use strict";e.exports=require("mongoose")},461:e=>{"use strict";e.exports=require("multer")},903:e=>{"use strict";e.exports=require("uuid")},928:e=>{"use strict";e.exports=require("path")},16:e=>{"use strict";e.exports=require("url")}},t={};!function r(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}(578)})();